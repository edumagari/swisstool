<!doctype html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="Swisstool - Ferramentas de precisão com tecnologia Suíça." />
    <meta name="robots" content="index,follow" />
    <meta name="theme-color" content="#0d6efd" />
    <link rel="icon" type="image/x-icon" href="/img/favicon.jpg" />

    <title>Swisstool</title>

    <!-- External CDNs exactly as original -->
    <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>
    <link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin>
    <link rel="preconnect" href="https://unpkg.com" crossorigin>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    <link rel="stylesheet" href="https://unpkg.com/swiper/swiper-bundle.min.css">
    <meta property="og:site_name" content="Swisstool" />
    <meta property="og:type" content="website" />
    <meta property="og:image" content="/img/logo_swisstool.png" />
    <meta name="twitter:card" content="summary_large_image" />

    <!-- Preload correct CSS before React mounts to prevent flash of unstyled content -->
    <script>
      (function(){
        function computeCss(lang, rest){
          const isHome = rest === ''
          const isProducts = /^(produtos|products|productos)$/.test(rest)
          const isCompany = /^(empresa|company)$/.test(rest)
          const isServices = /^(servicos|services|servicios)$/.test(rest)
          const isContact = /^(contato|contact|contacto)$/.test(rest)
          const isProductDetail = /^(produtos|products|productos)\//.test(rest)
          if (isProductDetail) return ['/css/global-modern.css']
          if (isHome) return ['/css/app.css']
          if (isProducts) return ['/css/global-modern.css','/css/app.css','/css/produtos.css']
          if (isCompany) return ['/css/global-modern.css','/css/app.css','/css/empresa.css']
          if (isServices) return ['/css/global-modern.css','/css/app.css','/css/servicos.css']
          if (isContact) return ['/css/global-modern.css','/css/app.css','/css/contato.css']
          return ['/css/app.css']
        }

        // Add loading indicator
        document.body.classList.add('css-loading')

        var hash = window.location.hash || '#/pt'
        var path = hash.replace(/^#/, '')
        var parts = path.split('/')
        var lang = parts[1] || 'pt'
        var rest = parts.slice(2).join('/')
        var cssSet = computeCss(lang, rest)
        window.__dynamicStyles = window.__dynamicStyles || {}
        var loadCount = 0
        var totalToLoad = cssSet.filter(function(h) { return !window.__dynamicStyles[h] }).length

        cssSet.forEach(function(href){
          if (window.__dynamicStyles[href]) return
          var l = document.createElement('link')
          l.rel = 'stylesheet'
          l.href = href
          l.setAttribute('data-dynamic-style', 'yes')

          // Add load handlers for initial CSS
          l.onload = function() {
            loadCount++
            if (loadCount >= totalToLoad) {
              document.body.classList.remove('css-loading')
            }
          }

          l.onerror = function() {
            console.error('Failed to load initial CSS:', href)
            loadCount++
            if (loadCount >= totalToLoad) {
              document.body.classList.remove('css-loading')
            }
          }

          document.head.appendChild(l)
          window.__dynamicStyles[href] = l
        })

        // Fallback: remove loading class after 2 seconds
        setTimeout(function() {
          document.body.classList.remove('css-loading')
        }, 2000)
      })();
    </script>
  </head>
  <body>
    <div id="root"></div>

    <!-- JS CDNs -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <script src="https://unpkg.com/swiper/swiper-bundle.min.js"></script>

    <!-- AOS initialization fallback and error handling -->
    <script>
      // Wait for AOS to be available and provide initialization helper
      window.addEventListener('load', function() {
        // Ensure AOS is available globally
        if (typeof AOS === 'undefined') {
          console.error('AOS library failed to load, attempting fallback...')
          // Try to load AOS from alternative CDN
          var script = document.createElement('script')
          script.src = 'https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.js'
          script.onload = function() {
            console.log('AOS loaded from fallback CDN')
            if (window.AOS) {
              window.dispatchEvent(new Event('aos-loaded'))
            }
          }
          script.onerror = function() {
            console.error('Failed to load AOS from fallback CDN')
            // Create a dummy AOS object to prevent errors
            window.AOS = {
              init: function() { console.warn('AOS not available, animations disabled') },
              refresh: function() { },
              refreshHard: function() { }
            }
          }
          document.head.appendChild(script)
        } else {
          // AOS loaded successfully
          window.dispatchEvent(new Event('aos-loaded'))
        }

        // Global error handler for animation issues
        window.addEventListener('error', function(e) {
          if (e.message && e.message.includes('AOS')) {
            console.error('AOS error caught:', e)
            // Attempt recovery
            if (window.AOS && window.AOS.refresh) {
              setTimeout(function() {
                try {
                  window.AOS.refresh()
                } catch (err) {
                  console.error('Failed to recover AOS:', err)
                }
              }, 100)
            }
          }
        })
      })

      // Provide helper for React to check AOS status
      window.isAOSReady = function() {
        return typeof AOS !== 'undefined' && AOS.init && AOS.refresh
      }
    </script>

    <script type="module" src="/src/main.jsx"></script>
  </body>
  
</html>
